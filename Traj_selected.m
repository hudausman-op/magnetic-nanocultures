id_choose = [2,1,6,5,7,3,4];


%53,65,143,78,90,69,71,59,38,46,77,117,62,45,122,121,93,125,126,124,127,137,139,26,42,23,40,67,130,143,20,29,97,25];
figure()
hold on

res_select = [];
for i = 1:length(id_choose)
    idx = res(:,8) == id_choose(i);
    res_select = [res_select;res(idx,:)];
    plot(res(idx,1), res(idx,7),'o', 'DisplayName',num2str(id(id_choose(i))));
end


%OUTPUTS
%
% - Creates a subfolder called "Feature_Finding" where it outputs the
% accepted features' MT matrix (from feature2D) as "MT_##_Feat_Size_"
% featuresize ".mat"
% - copies last frame into same subfolder
%
% MT matrix format:
% 1 row per bead per frame, sorted by frame number then x position (roughly)
% columns:
% 1:2 - X and Y positions (in pixels)
% 3   - Integrated intensity
% 4   - Rg squared of feature
% 5   - eccentricity
% 6   - frame #
% 7   - time of frame


%id_choose for 5nm = [257,253,187,188,163,192,205,215,115,64,152,162,96,126,147,146,238,202,182,136,210,71,69,135,88,166,45,122,70,208];
% id_choose for 10 nm= [592,483,321,462,236,322,498,512,208,388,601,162,463,141,163,581,580,186,279,290,391,237,364,499,257,187,324,85];
% id_choose for 20nm = [156,155,152,151,147,150,91,92,90,93,104,132,103,47,48,153,131,138];
%October-03-2023: 
% id_choose for 5nm [53,59,38,93,84,28,31,83,37,19,13,60,80,55,18,32];
% id_choose for 10nm [104,135,179,95,116,125,86,103,251,198,68,96,142,69,67,217,87,140,215,70,143,169,105,35,88,141,48,50,107,47,106,53,208,51,33,136,52,20,25,195,183,38,24,97,89,75,21,23,131,29,153,9,32,36,132,72,10,49,137,108,80,12,110,8,57,74,6,227,17,11,34,55,22,54];
%id_choose for ECOLI Nikon = [83,68,82,61,36,51,73,81,75,52,20,28,12,35,60,41,76,59,58,10,25,84,74,13,7,57,42,43];
%id_choose for bulk = [182, 180, 178, 176,169,196,353,163,185,187,191,157,195,174,153,150,165,367,309,379,166,154,183,156,134,147,131,158,141,127,167,358,373,151,188,133,129,170,356,138,123,130,193,173,116,125,144,115,164,101,97,89,109,149,120,128,98,401,192,124,108,347,117,83,190,118,102,152,93,95,103,366,105,111,143,100,90,114,162,159,99,88,168,74,82,96,94,84,112,139,71,146,75,80,119,374,110,171,53,126,63,44,41,60,21,56,407,37,57,42,38,91,33,68,148,340,25,106,345,51,86,47,27,58,87,76,254,179,327,30,455,35,92,7,16,20,11,145,66,9,404,142,161,69,43,368,32,355,5,186,189,40,6,34,3,324,121,54,177,175,4,317,36,78,18,29,1,22,352,399,113,10,31,13,135,181,172,104,344,346,85,376,23,12,61,349,291,360,357,262,136,67,330,219,155,348,194,460,48,272,363,422,466,326,46,197,300,24,65,308,73,364,329,343,361,333,292,310,312,362,17,351,14,8,79,463,350,307,107,375,49,19,322,303,335,184,55,385,137,72,62,316,370,323,289,140,122,263,321,331,394,354,250,341,369,314,315,293,297,384,319,270,332,337,39,238,365,283,285,269,260,268,342,298,280,245,440,264,295,328,286,318,279,334,372,389,392,338,406,45,244,253,227,299,288,237,416,267,274,417,313,258,259,438,381,456,132,241,290,229,304,277,236,242,215,266,305,248,28,294,306,160,276,50,233,246,223,232,243,64,282,388,228,400,457,378,423,419,403,284,302,239,398,339,275,380,265,390,77,459,444,2,425,435,458,430,70,431,446,59,442,414,81,465,15];
%id_choose = [1,2,3,4,5,6,7,8,9,10]; for red channel sorting vdo
%id_choose = [29,5,7,2,1,9,15,8,16,4]; for green channel sorting vdo


